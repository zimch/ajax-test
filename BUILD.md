# Build & Run

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–ø–∏—Å–∞–Ω–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º java 17.

* [Build & Run](#build--run)
    * [Local](#local)
    * [Docker](#docker)
        * [Build](#build)
        * [Build & Export](#build--export)
        * [Compose](#compose)
        * [Deploy](#deploy)
            * [–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫](#–ø–µ—Ä–≤—ã–π-–∑–∞–ø—É—Å–∫)
            * [–ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫](#–ø–æ–≤—Ç–æ—Ä–Ω—ã–π-–∑–∞–ø—É—Å–∫)

## Local

–°–±–æ—Ä–∫—É –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥–æ–π:

```shell
mvn clean install
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥–æ–π:

```shell
java -jar .\target\AjaxTest-0.0.1-SNAPSHOT.jar
```

## Docker

### Build

–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è `docker image` –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥–æ–π:

```shell
docker build --no-cache -t ajaxtest .
```

–ß—Ç–æ–± –Ω–µ –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å –∫–æ–º–∞–Ω–¥—É –∏ –Ω–µ –Ω–∞–ø—É—Ç–∞—Ç—å —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏, –≤ –ø—Ä–æ–µ–∫—Ç–µ –µ—Å—Ç—å —Å–∫—Ä–∏–ø—Ç —Å —ç—Ç–æ–π
–∫–æ–º–∞–Ω–¥–æ–π: [build-helper](build-helper).

```shell
./build-helper
```

### Build & Export

–¢–∞–∫–∂–µ, —Ç.–∫. –º—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞–∫–æ–π-–ª–∏–±–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –µ—Å—Ç—å
—Å–∫—Ä–∏–ø—Ç [build-and-export-helper](build-and-export-helper) –∫–æ—Ç–æ—Ä—ã–π —Ç–∞–∫–∂–µ —Å–æ–±–∏—Ä–∞–µ—Ç
–Ω–æ–≤—ã–π `docker image` –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç `image + docker-compose.yml` –≤ –∞—Ä—Ö–∏–≤ `/target/ajaxtest-image-and-compose.tar.gz`
–∫–æ—Ç–æ—Ä—ã–π –¥–∞–ª—å—à–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–º–µ—â–∞—Ç—å –Ω–∞ –¥—Ä—É–≥—É—é –º–∞—à–∏–Ω—É.

```shell
./build-and-export-helper
```

### Compose

[docker-compose.yml](docker-compose.yml) —Ñ–∞–π–ª –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –±—É–¥—É—Ç –∑–∞–ø—É—â–µ–Ω—ã –∏ —Å –∫–∞–∫–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.

### Deploy

#### –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫

–î–ª—è —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤ –ø–µ—Ä–≤—ã–π —Ä–∞–∑ –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â—É—é –ø—Ä–æ—Ü–µ–¥—É—Ä—É:

1. –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `/var/lib/ajaxtest` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–±–æ—Ç—ã:
    ```shell
    mkdir /var/lib/ajaxtest
    ```

2. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∞—Ä—Ö–∏–≤ —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –∏–∑ –ø—É–Ω–∫—Ç–∞ [Build & Export](#build--export) –≤ –ø–∞–ø–∫—É `/var/lib/ajaxtest`.

3. –†–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å –∞—Ä—Ö–∏–≤:
   ```shell
   tar -xzvf ajaxtest-image-and-compose.tar.gz
   ```
4. –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å `image` –≤ `docker`:
   ```shell
   docker load < ajaxtest-image.tar
   ```
5. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –Ω—É–∂–Ω—ã–º –ø—Ä–æ—Ñ–∏–ª–µ–º —á–µ—Ä–µ–∑ `docker compose`:
   ```shell
   docker compose --profile PROFILE_NAME up -d
   ```
   –î–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏: `default`, –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ [Compose](#compose).

6. –†–∞–¥–æ–≤–∞—Ç—å—Å—è —á—Ç–æ –≤—Å–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å.

#### –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫

–î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø—É–Ω–∫—Ç—ã `2.`, `3.`, `4.`, `5.`, `6.`.

```shell
# 2. –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –Ω–æ–≤—ã–π –∞—Ä—Ö–∏–≤ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é /var/lib/ajaxtest
 
# 3. –†–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å –∞—Ä—Ö–∏–≤
tar -xzvf ajaxtest-image-and-compose.tar.gz

# 4. –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å image
docker load < ajaxtest-image.tar

# 5. –ó–∞–ø—É—Å—Ç–∏—Ç—å docker-compose
docker compose --profile PROFILE_NAME up -d

# 6. ü•≥üéâ
```